import { Component, EventEmitter, Input, Output, } from '@angular/core';
import * as i0 from "@angular/core";
import * as i1 from "../custom-templates.service";
import * as i2 from "../attachment.service";
import * as i3 from "@angular/common";
import * as i4 from "../icon/icon-placeholder/icon-placeholder.component";
import * as i5 from "../icon/loading-indicator-placeholder/loading-indicator-placeholder.component";
/**
 * The `AttachmentPreviewList` component displays a preview of the attachments uploaded to a message. Users can delete attachments using the preview component, or retry upload if it failed previously.
 */
export class AttachmentPreviewListComponent {
    constructor(customTemplateService, attachmentService) {
        this.customTemplateService = customTemplateService;
        this.attachmentService = attachmentService;
        /**
         * An output to notify the parent component if the user tries to retry a failed upload
         */
        this.retryAttachmentUpload = new EventEmitter();
        /**
         * An output to notify the parent component if the user wants to delete a file
         */
        this.deleteAttachment = new EventEmitter();
        this.customAttachments = [];
        this.subscriptions = [];
    }
    ngOnInit() {
        this.subscriptions.push(this.customTemplateService.customAttachmentPreviewListTemplate$.subscribe((t) => (this.customAttachmentsPreview = t)));
        this.subscriptions.push(this.attachmentService.customAttachments$.subscribe((a) => (this.customAttachments = a)));
    }
    ngOnDestroy() {
        this.subscriptions.forEach((s) => s.unsubscribe());
    }
    attachmentUploadRetried(file) {
        this.retryAttachmentUpload.emit(file);
    }
    attachmentDeleted(upload) {
        this.deleteAttachment.emit(upload);
    }
    trackByFile(_, item) {
        return item.file;
    }
}
AttachmentPreviewListComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.0.4", ngImport: i0, type: AttachmentPreviewListComponent, deps: [{ token: i1.CustomTemplatesService }, { token: i2.AttachmentService }], target: i0.ɵɵFactoryTarget.Component });
AttachmentPreviewListComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.0.4", type: AttachmentPreviewListComponent, selector: "stream-attachment-preview-list", inputs: { attachmentUploads$: "attachmentUploads$" }, outputs: { retryAttachmentUpload: "retryAttachmentUpload", deleteAttachment: "deleteAttachment" }, ngImport: i0, template: "<div\n  *ngIf=\"\n    (attachmentUploads$ | async)?.length ||\n    (customAttachments.length > 0 && customAttachmentsPreview)\n  \"\n  class=\"str-chat__attachment-preview-list\"\n>\n  <div class=\"str-chat__attachment-list-scroll-container\">\n    <ng-container\n      *ngFor=\"\n        let attachmentUpload of attachmentUploads$ | async;\n        trackBy: trackByFile\n      \"\n    >\n      <div\n        *ngIf=\"attachmentUpload.type === 'image'\"\n        class=\"str-chat__attachment-preview-image\"\n        data-testclass=\"attachment-image-preview\"\n      >\n        <ng-container\n          *ngTemplateOutlet=\"\n            deleteButton;\n            context: { attachmentUpload: attachmentUpload }\n          \"\n        ></ng-container>\n        <div\n          *ngIf=\"attachmentUpload.state === 'uploading'\"\n          class=\"str-chat__attachment-preview-image-loading\"\n        >\n          <stream-loading-indicator-placeholder\n            data-testclass=\"loading-indicator\"\n          ></stream-loading-indicator-placeholder>\n        </div>\n        <ng-container\n          *ngTemplateOutlet=\"\n            retryButton;\n            context: { attachmentUpload: attachmentUpload }\n          \"\n        ></ng-container>\n        <img\n          *ngIf=\"attachmentUpload.url || attachmentUpload.previewUri\"\n          class=\"str-chat__attachment-preview-thumbnail\"\n          data-testclass=\"attachment-image\"\n          src=\"{{\n            attachmentUpload.url\n              ? attachmentUpload.url\n              : attachmentUpload.previewUri\n          }}\"\n          alt=\"{{ attachmentUpload.file.name }}\"\n        />\n      </div>\n      <div\n        *ngIf=\"\n          attachmentUpload.type === 'file' ||\n          attachmentUpload.type === 'video' ||\n          attachmentUpload.type === 'voiceRecording'\n        \"\n        class=\"str-chat__attachment-preview-file str-chat__attachment-preview-type-{{\n          attachmentUpload.type\n        }}\"\n        data-testclass=\"attachment-file-preview\"\n      >\n        <stream-icon-placeholder\n          class=\"str-chat__attachment-preview-file-icon\"\n          icon=\"unspecified-filetype\"\n        ></stream-icon-placeholder>\n\n        <div class=\"str-chat__attachment-preview-file-end\">\n          <div\n            class=\"str-chat__attachment-preview-file-name\"\n            title=\"{{ attachmentUpload.file.name }}\"\n          >\n            {{ attachmentUpload.file.name }}\n          </div>\n          <a\n            *ngIf=\"attachmentUpload.state === 'success'\"\n            class=\"str-chat__attachment-preview-file-download\"\n            data-testclass=\"file-download-link\"\n            download\n            href=\"{{ attachmentUpload.url }}\"\n            (click)=\"attachmentUpload.url ? null : $event.preventDefault()\"\n            (keyup.enter)=\"\n              attachmentUpload.url ? null : $event.preventDefault()\n            \"\n          >\n            <stream-icon-placeholder icon=\"download\"></stream-icon-placeholder>\n          </a>\n          <stream-loading-indicator-placeholder\n            *ngIf=\"attachmentUpload.state === 'uploading'\"\n            data-testclass=\"loading-indicator\"\n          ></stream-loading-indicator-placeholder>\n        </div>\n        <ng-container\n          *ngTemplateOutlet=\"\n            deleteButton;\n            context: { attachmentUpload: attachmentUpload }\n          \"\n        ></ng-container>\n        <ng-container\n          *ngTemplateOutlet=\"\n            retryButton;\n            context: { attachmentUpload: attachmentUpload }\n          \"\n        ></ng-container>\n      </div>\n    </ng-container>\n    <ng-container *ngIf=\"customAttachmentsPreview\">\n      <ng-template\n        *ngTemplateOutlet=\"\n          customAttachmentsPreview;\n          context: { service: attachmentService }\n        \"\n      ></ng-template>\n    </ng-container>\n  </div>\n</div>\n\n<ng-template #deleteButton let-attachmentUpload=\"attachmentUpload\">\n  <div\n    class=\"str-chat__attachment-preview-delete\"\n    data-testclass=\"file-delete\"\n    role=\"button\"\n    (click)=\"attachmentDeleted(attachmentUpload)\"\n    (keyup.enter)=\"attachmentDeleted(attachmentUpload)\"\n  >\n    <stream-icon-placeholder icon=\"close\"></stream-icon-placeholder>\n  </div>\n</ng-template>\n\n<ng-template #retryButton let-attachmentUpload=\"attachmentUpload\">\n  <div\n    *ngIf=\"attachmentUpload.state === 'error'\"\n    data-testclass=\"upload-retry\"\n    class=\"str-chat__attachment-preview-error str-chat__attachment-preview-error-{{\n      attachmentUpload.type === 'image' ? 'image' : 'file'\n    }}\"\n    (click)=\"attachmentUploadRetried(attachmentUpload.file)\"\n    (keyup.enter)=\"attachmentUploadRetried(attachmentUpload.file)\"\n  >\n    <stream-icon-placeholder icon=\"retry\"></stream-icon-placeholder>\n  </div>\n</ng-template>\n", dependencies: [{ kind: "directive", type: i3.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i3.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i3.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "component", type: i4.IconPlaceholderComponent, selector: "stream-icon-placeholder", inputs: ["icon"] }, { kind: "component", type: i5.LoadingIndicatorPlaceholderComponent, selector: "stream-loading-indicator-placeholder" }, { kind: "pipe", type: i3.AsyncPipe, name: "async" }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.0.4", ngImport: i0, type: AttachmentPreviewListComponent, decorators: [{
            type: Component,
            args: [{ selector: 'stream-attachment-preview-list', template: "<div\n  *ngIf=\"\n    (attachmentUploads$ | async)?.length ||\n    (customAttachments.length > 0 && customAttachmentsPreview)\n  \"\n  class=\"str-chat__attachment-preview-list\"\n>\n  <div class=\"str-chat__attachment-list-scroll-container\">\n    <ng-container\n      *ngFor=\"\n        let attachmentUpload of attachmentUploads$ | async;\n        trackBy: trackByFile\n      \"\n    >\n      <div\n        *ngIf=\"attachmentUpload.type === 'image'\"\n        class=\"str-chat__attachment-preview-image\"\n        data-testclass=\"attachment-image-preview\"\n      >\n        <ng-container\n          *ngTemplateOutlet=\"\n            deleteButton;\n            context: { attachmentUpload: attachmentUpload }\n          \"\n        ></ng-container>\n        <div\n          *ngIf=\"attachmentUpload.state === 'uploading'\"\n          class=\"str-chat__attachment-preview-image-loading\"\n        >\n          <stream-loading-indicator-placeholder\n            data-testclass=\"loading-indicator\"\n          ></stream-loading-indicator-placeholder>\n        </div>\n        <ng-container\n          *ngTemplateOutlet=\"\n            retryButton;\n            context: { attachmentUpload: attachmentUpload }\n          \"\n        ></ng-container>\n        <img\n          *ngIf=\"attachmentUpload.url || attachmentUpload.previewUri\"\n          class=\"str-chat__attachment-preview-thumbnail\"\n          data-testclass=\"attachment-image\"\n          src=\"{{\n            attachmentUpload.url\n              ? attachmentUpload.url\n              : attachmentUpload.previewUri\n          }}\"\n          alt=\"{{ attachmentUpload.file.name }}\"\n        />\n      </div>\n      <div\n        *ngIf=\"\n          attachmentUpload.type === 'file' ||\n          attachmentUpload.type === 'video' ||\n          attachmentUpload.type === 'voiceRecording'\n        \"\n        class=\"str-chat__attachment-preview-file str-chat__attachment-preview-type-{{\n          attachmentUpload.type\n        }}\"\n        data-testclass=\"attachment-file-preview\"\n      >\n        <stream-icon-placeholder\n          class=\"str-chat__attachment-preview-file-icon\"\n          icon=\"unspecified-filetype\"\n        ></stream-icon-placeholder>\n\n        <div class=\"str-chat__attachment-preview-file-end\">\n          <div\n            class=\"str-chat__attachment-preview-file-name\"\n            title=\"{{ attachmentUpload.file.name }}\"\n          >\n            {{ attachmentUpload.file.name }}\n          </div>\n          <a\n            *ngIf=\"attachmentUpload.state === 'success'\"\n            class=\"str-chat__attachment-preview-file-download\"\n            data-testclass=\"file-download-link\"\n            download\n            href=\"{{ attachmentUpload.url }}\"\n            (click)=\"attachmentUpload.url ? null : $event.preventDefault()\"\n            (keyup.enter)=\"\n              attachmentUpload.url ? null : $event.preventDefault()\n            \"\n          >\n            <stream-icon-placeholder icon=\"download\"></stream-icon-placeholder>\n          </a>\n          <stream-loading-indicator-placeholder\n            *ngIf=\"attachmentUpload.state === 'uploading'\"\n            data-testclass=\"loading-indicator\"\n          ></stream-loading-indicator-placeholder>\n        </div>\n        <ng-container\n          *ngTemplateOutlet=\"\n            deleteButton;\n            context: { attachmentUpload: attachmentUpload }\n          \"\n        ></ng-container>\n        <ng-container\n          *ngTemplateOutlet=\"\n            retryButton;\n            context: { attachmentUpload: attachmentUpload }\n          \"\n        ></ng-container>\n      </div>\n    </ng-container>\n    <ng-container *ngIf=\"customAttachmentsPreview\">\n      <ng-template\n        *ngTemplateOutlet=\"\n          customAttachmentsPreview;\n          context: { service: attachmentService }\n        \"\n      ></ng-template>\n    </ng-container>\n  </div>\n</div>\n\n<ng-template #deleteButton let-attachmentUpload=\"attachmentUpload\">\n  <div\n    class=\"str-chat__attachment-preview-delete\"\n    data-testclass=\"file-delete\"\n    role=\"button\"\n    (click)=\"attachmentDeleted(attachmentUpload)\"\n    (keyup.enter)=\"attachmentDeleted(attachmentUpload)\"\n  >\n    <stream-icon-placeholder icon=\"close\"></stream-icon-placeholder>\n  </div>\n</ng-template>\n\n<ng-template #retryButton let-attachmentUpload=\"attachmentUpload\">\n  <div\n    *ngIf=\"attachmentUpload.state === 'error'\"\n    data-testclass=\"upload-retry\"\n    class=\"str-chat__attachment-preview-error str-chat__attachment-preview-error-{{\n      attachmentUpload.type === 'image' ? 'image' : 'file'\n    }}\"\n    (click)=\"attachmentUploadRetried(attachmentUpload.file)\"\n    (keyup.enter)=\"attachmentUploadRetried(attachmentUpload.file)\"\n  >\n    <stream-icon-placeholder icon=\"retry\"></stream-icon-placeholder>\n  </div>\n</ng-template>\n" }]
        }], ctorParameters: function () { return [{ type: i1.CustomTemplatesService }, { type: i2.AttachmentService }]; }, propDecorators: { attachmentUploads$: [{
                type: Input
            }], retryAttachmentUpload: [{
                type: Output
            }], deleteAttachment: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXR0YWNobWVudC1wcmV2aWV3LWxpc3QuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvc3RyZWFtLWNoYXQtYW5ndWxhci9zcmMvbGliL2F0dGFjaG1lbnQtcHJldmlldy1saXN0L2F0dGFjaG1lbnQtcHJldmlldy1saXN0LmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3N0cmVhbS1jaGF0LWFuZ3VsYXIvc3JjL2xpYi9hdHRhY2htZW50LXByZXZpZXctbGlzdC9hdHRhY2htZW50LXByZXZpZXctbGlzdC5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ0wsU0FBUyxFQUNULFlBQVksRUFDWixLQUFLLEVBR0wsTUFBTSxHQUVQLE1BQU0sZUFBZSxDQUFDOzs7Ozs7O0FBT3ZCOztHQUVHO0FBTUgsTUFBTSxPQUFPLDhCQUE4QjtJQWlCekMsWUFDVSxxQkFBNkMsRUFDckMsaUJBQW9DO1FBRDVDLDBCQUFxQixHQUFyQixxQkFBcUIsQ0FBd0I7UUFDckMsc0JBQWlCLEdBQWpCLGlCQUFpQixDQUFtQjtRQWR0RDs7V0FFRztRQUNnQiwwQkFBcUIsR0FBRyxJQUFJLFlBQVksRUFBUSxDQUFDO1FBQ3BFOztXQUVHO1FBQ2dCLHFCQUFnQixHQUFHLElBQUksWUFBWSxFQUFvQixDQUFDO1FBQzNFLHNCQUFpQixHQUFpQixFQUFFLENBQUM7UUFFN0Isa0JBQWEsR0FBbUIsRUFBRSxDQUFDO0lBS3hDLENBQUM7SUFFSixRQUFRO1FBQ04sSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQ3JCLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxvQ0FBb0MsQ0FBQyxTQUFTLENBQ3ZFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyx3QkFBd0IsR0FBRyxDQUFDLENBQUMsQ0FDM0MsQ0FDRixDQUFDO1FBQ0YsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQ3JCLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxrQkFBa0IsQ0FBQyxTQUFTLENBQ2pELENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxDQUFDLENBQUMsQ0FDcEMsQ0FDRixDQUFDO0lBQ0osQ0FBQztJQUVELFdBQVc7UUFDVCxJQUFJLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7SUFDckQsQ0FBQztJQUVELHVCQUF1QixDQUFDLElBQVU7UUFDaEMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN4QyxDQUFDO0lBRUQsaUJBQWlCLENBQUMsTUFBd0I7UUFDeEMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNyQyxDQUFDO0lBRUQsV0FBVyxDQUFDLENBQVMsRUFBRSxJQUFzQjtRQUMzQyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUM7SUFDbkIsQ0FBQzs7MkhBakRVLDhCQUE4QjsrR0FBOUIsOEJBQThCLCtOQ3ZCM0MsNjBKQThJQTsyRkR2SGEsOEJBQThCO2tCQUwxQyxTQUFTOytCQUNFLGdDQUFnQzs2SUFRakMsa0JBQWtCO3NCQUExQixLQUFLO2dCQUlhLHFCQUFxQjtzQkFBdkMsTUFBTTtnQkFJWSxnQkFBZ0I7c0JBQWxDLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb21wb25lbnQsXG4gIEV2ZW50RW1pdHRlcixcbiAgSW5wdXQsXG4gIE9uRGVzdHJveSxcbiAgT25Jbml0LFxuICBPdXRwdXQsXG4gIFRlbXBsYXRlUmVmLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE9ic2VydmFibGUsIFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgQXR0YWNobWVudFVwbG9hZCwgQ3VzdG9tQXR0YWNobWVudFByZXZpZXdMaXN0Q29udGV4dCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IEN1c3RvbVRlbXBsYXRlc1NlcnZpY2UgfSBmcm9tICcuLi9jdXN0b20tdGVtcGxhdGVzLnNlcnZpY2UnO1xuaW1wb3J0IHsgQXR0YWNobWVudFNlcnZpY2UgfSBmcm9tICcuLi9hdHRhY2htZW50LnNlcnZpY2UnO1xuaW1wb3J0IHsgQXR0YWNobWVudCB9IGZyb20gJ3N0cmVhbS1jaGF0JztcblxuLyoqXG4gKiBUaGUgYEF0dGFjaG1lbnRQcmV2aWV3TGlzdGAgY29tcG9uZW50IGRpc3BsYXlzIGEgcHJldmlldyBvZiB0aGUgYXR0YWNobWVudHMgdXBsb2FkZWQgdG8gYSBtZXNzYWdlLiBVc2VycyBjYW4gZGVsZXRlIGF0dGFjaG1lbnRzIHVzaW5nIHRoZSBwcmV2aWV3IGNvbXBvbmVudCwgb3IgcmV0cnkgdXBsb2FkIGlmIGl0IGZhaWxlZCBwcmV2aW91c2x5LlxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdzdHJlYW0tYXR0YWNobWVudC1wcmV2aWV3LWxpc3QnLFxuICB0ZW1wbGF0ZVVybDogJy4vYXR0YWNobWVudC1wcmV2aWV3LWxpc3QuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZXM6IFtdLFxufSlcbmV4cG9ydCBjbGFzcyBBdHRhY2htZW50UHJldmlld0xpc3RDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XG4gIC8qKlxuICAgKiBBIHN0cmVhbSB0aGF0IGVtaXRzIHRoZSBjdXJyZW50IGZpbGUgdXBsb2FkcyBhbmQgdGhlaXIgc3RhdGVzXG4gICAqL1xuICBASW5wdXQoKSBhdHRhY2htZW50VXBsb2FkcyQ6IE9ic2VydmFibGU8QXR0YWNobWVudFVwbG9hZFtdPiB8IHVuZGVmaW5lZDtcbiAgLyoqXG4gICAqIEFuIG91dHB1dCB0byBub3RpZnkgdGhlIHBhcmVudCBjb21wb25lbnQgaWYgdGhlIHVzZXIgdHJpZXMgdG8gcmV0cnkgYSBmYWlsZWQgdXBsb2FkXG4gICAqL1xuICBAT3V0cHV0KCkgcmVhZG9ubHkgcmV0cnlBdHRhY2htZW50VXBsb2FkID0gbmV3IEV2ZW50RW1pdHRlcjxGaWxlPigpO1xuICAvKipcbiAgICogQW4gb3V0cHV0IHRvIG5vdGlmeSB0aGUgcGFyZW50IGNvbXBvbmVudCBpZiB0aGUgdXNlciB3YW50cyB0byBkZWxldGUgYSBmaWxlXG4gICAqL1xuICBAT3V0cHV0KCkgcmVhZG9ubHkgZGVsZXRlQXR0YWNobWVudCA9IG5ldyBFdmVudEVtaXR0ZXI8QXR0YWNobWVudFVwbG9hZD4oKTtcbiAgY3VzdG9tQXR0YWNobWVudHM6IEF0dGFjaG1lbnRbXSA9IFtdO1xuICBjdXN0b21BdHRhY2htZW50c1ByZXZpZXc/OiBUZW1wbGF0ZVJlZjxDdXN0b21BdHRhY2htZW50UHJldmlld0xpc3RDb250ZXh0PjtcbiAgcHJpdmF0ZSBzdWJzY3JpcHRpb25zOiBTdWJzY3JpcHRpb25bXSA9IFtdO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgY3VzdG9tVGVtcGxhdGVTZXJ2aWNlOiBDdXN0b21UZW1wbGF0ZXNTZXJ2aWNlLFxuICAgIHB1YmxpYyByZWFkb25seSBhdHRhY2htZW50U2VydmljZTogQXR0YWNobWVudFNlcnZpY2VcbiAgKSB7fVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5wdXNoKFxuICAgICAgdGhpcy5jdXN0b21UZW1wbGF0ZVNlcnZpY2UuY3VzdG9tQXR0YWNobWVudFByZXZpZXdMaXN0VGVtcGxhdGUkLnN1YnNjcmliZShcbiAgICAgICAgKHQpID0+ICh0aGlzLmN1c3RvbUF0dGFjaG1lbnRzUHJldmlldyA9IHQpXG4gICAgICApXG4gICAgKTtcbiAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaChcbiAgICAgIHRoaXMuYXR0YWNobWVudFNlcnZpY2UuY3VzdG9tQXR0YWNobWVudHMkLnN1YnNjcmliZShcbiAgICAgICAgKGEpID0+ICh0aGlzLmN1c3RvbUF0dGFjaG1lbnRzID0gYSlcbiAgICAgIClcbiAgICApO1xuICB9XG5cbiAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5zdWJzY3JpcHRpb25zLmZvckVhY2goKHMpID0+IHMudW5zdWJzY3JpYmUoKSk7XG4gIH1cblxuICBhdHRhY2htZW50VXBsb2FkUmV0cmllZChmaWxlOiBGaWxlKSB7XG4gICAgdGhpcy5yZXRyeUF0dGFjaG1lbnRVcGxvYWQuZW1pdChmaWxlKTtcbiAgfVxuXG4gIGF0dGFjaG1lbnREZWxldGVkKHVwbG9hZDogQXR0YWNobWVudFVwbG9hZCkge1xuICAgIHRoaXMuZGVsZXRlQXR0YWNobWVudC5lbWl0KHVwbG9hZCk7XG4gIH1cblxuICB0cmFja0J5RmlsZShfOiBudW1iZXIsIGl0ZW06IEF0dGFjaG1lbnRVcGxvYWQpIHtcbiAgICByZXR1cm4gaXRlbS5maWxlO1xuICB9XG59XG4iLCI8ZGl2XG4gICpuZ0lmPVwiXG4gICAgKGF0dGFjaG1lbnRVcGxvYWRzJCB8IGFzeW5jKT8ubGVuZ3RoIHx8XG4gICAgKGN1c3RvbUF0dGFjaG1lbnRzLmxlbmd0aCA+IDAgJiYgY3VzdG9tQXR0YWNobWVudHNQcmV2aWV3KVxuICBcIlxuICBjbGFzcz1cInN0ci1jaGF0X19hdHRhY2htZW50LXByZXZpZXctbGlzdFwiXG4+XG4gIDxkaXYgY2xhc3M9XCJzdHItY2hhdF9fYXR0YWNobWVudC1saXN0LXNjcm9sbC1jb250YWluZXJcIj5cbiAgICA8bmctY29udGFpbmVyXG4gICAgICAqbmdGb3I9XCJcbiAgICAgICAgbGV0IGF0dGFjaG1lbnRVcGxvYWQgb2YgYXR0YWNobWVudFVwbG9hZHMkIHwgYXN5bmM7XG4gICAgICAgIHRyYWNrQnk6IHRyYWNrQnlGaWxlXG4gICAgICBcIlxuICAgID5cbiAgICAgIDxkaXZcbiAgICAgICAgKm5nSWY9XCJhdHRhY2htZW50VXBsb2FkLnR5cGUgPT09ICdpbWFnZSdcIlxuICAgICAgICBjbGFzcz1cInN0ci1jaGF0X19hdHRhY2htZW50LXByZXZpZXctaW1hZ2VcIlxuICAgICAgICBkYXRhLXRlc3RjbGFzcz1cImF0dGFjaG1lbnQtaW1hZ2UtcHJldmlld1wiXG4gICAgICA+XG4gICAgICAgIDxuZy1jb250YWluZXJcbiAgICAgICAgICAqbmdUZW1wbGF0ZU91dGxldD1cIlxuICAgICAgICAgICAgZGVsZXRlQnV0dG9uO1xuICAgICAgICAgICAgY29udGV4dDogeyBhdHRhY2htZW50VXBsb2FkOiBhdHRhY2htZW50VXBsb2FkIH1cbiAgICAgICAgICBcIlxuICAgICAgICA+PC9uZy1jb250YWluZXI+XG4gICAgICAgIDxkaXZcbiAgICAgICAgICAqbmdJZj1cImF0dGFjaG1lbnRVcGxvYWQuc3RhdGUgPT09ICd1cGxvYWRpbmcnXCJcbiAgICAgICAgICBjbGFzcz1cInN0ci1jaGF0X19hdHRhY2htZW50LXByZXZpZXctaW1hZ2UtbG9hZGluZ1wiXG4gICAgICAgID5cbiAgICAgICAgICA8c3RyZWFtLWxvYWRpbmctaW5kaWNhdG9yLXBsYWNlaG9sZGVyXG4gICAgICAgICAgICBkYXRhLXRlc3RjbGFzcz1cImxvYWRpbmctaW5kaWNhdG9yXCJcbiAgICAgICAgICA+PC9zdHJlYW0tbG9hZGluZy1pbmRpY2F0b3ItcGxhY2Vob2xkZXI+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8bmctY29udGFpbmVyXG4gICAgICAgICAgKm5nVGVtcGxhdGVPdXRsZXQ9XCJcbiAgICAgICAgICAgIHJldHJ5QnV0dG9uO1xuICAgICAgICAgICAgY29udGV4dDogeyBhdHRhY2htZW50VXBsb2FkOiBhdHRhY2htZW50VXBsb2FkIH1cbiAgICAgICAgICBcIlxuICAgICAgICA+PC9uZy1jb250YWluZXI+XG4gICAgICAgIDxpbWdcbiAgICAgICAgICAqbmdJZj1cImF0dGFjaG1lbnRVcGxvYWQudXJsIHx8IGF0dGFjaG1lbnRVcGxvYWQucHJldmlld1VyaVwiXG4gICAgICAgICAgY2xhc3M9XCJzdHItY2hhdF9fYXR0YWNobWVudC1wcmV2aWV3LXRodW1ibmFpbFwiXG4gICAgICAgICAgZGF0YS10ZXN0Y2xhc3M9XCJhdHRhY2htZW50LWltYWdlXCJcbiAgICAgICAgICBzcmM9XCJ7e1xuICAgICAgICAgICAgYXR0YWNobWVudFVwbG9hZC51cmxcbiAgICAgICAgICAgICAgPyBhdHRhY2htZW50VXBsb2FkLnVybFxuICAgICAgICAgICAgICA6IGF0dGFjaG1lbnRVcGxvYWQucHJldmlld1VyaVxuICAgICAgICAgIH19XCJcbiAgICAgICAgICBhbHQ9XCJ7eyBhdHRhY2htZW50VXBsb2FkLmZpbGUubmFtZSB9fVwiXG4gICAgICAgIC8+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXZcbiAgICAgICAgKm5nSWY9XCJcbiAgICAgICAgICBhdHRhY2htZW50VXBsb2FkLnR5cGUgPT09ICdmaWxlJyB8fFxuICAgICAgICAgIGF0dGFjaG1lbnRVcGxvYWQudHlwZSA9PT0gJ3ZpZGVvJyB8fFxuICAgICAgICAgIGF0dGFjaG1lbnRVcGxvYWQudHlwZSA9PT0gJ3ZvaWNlUmVjb3JkaW5nJ1xuICAgICAgICBcIlxuICAgICAgICBjbGFzcz1cInN0ci1jaGF0X19hdHRhY2htZW50LXByZXZpZXctZmlsZSBzdHItY2hhdF9fYXR0YWNobWVudC1wcmV2aWV3LXR5cGUte3tcbiAgICAgICAgICBhdHRhY2htZW50VXBsb2FkLnR5cGVcbiAgICAgICAgfX1cIlxuICAgICAgICBkYXRhLXRlc3RjbGFzcz1cImF0dGFjaG1lbnQtZmlsZS1wcmV2aWV3XCJcbiAgICAgID5cbiAgICAgICAgPHN0cmVhbS1pY29uLXBsYWNlaG9sZGVyXG4gICAgICAgICAgY2xhc3M9XCJzdHItY2hhdF9fYXR0YWNobWVudC1wcmV2aWV3LWZpbGUtaWNvblwiXG4gICAgICAgICAgaWNvbj1cInVuc3BlY2lmaWVkLWZpbGV0eXBlXCJcbiAgICAgICAgPjwvc3RyZWFtLWljb24tcGxhY2Vob2xkZXI+XG5cbiAgICAgICAgPGRpdiBjbGFzcz1cInN0ci1jaGF0X19hdHRhY2htZW50LXByZXZpZXctZmlsZS1lbmRcIj5cbiAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICBjbGFzcz1cInN0ci1jaGF0X19hdHRhY2htZW50LXByZXZpZXctZmlsZS1uYW1lXCJcbiAgICAgICAgICAgIHRpdGxlPVwie3sgYXR0YWNobWVudFVwbG9hZC5maWxlLm5hbWUgfX1cIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIHt7IGF0dGFjaG1lbnRVcGxvYWQuZmlsZS5uYW1lIH19XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGFcbiAgICAgICAgICAgICpuZ0lmPVwiYXR0YWNobWVudFVwbG9hZC5zdGF0ZSA9PT0gJ3N1Y2Nlc3MnXCJcbiAgICAgICAgICAgIGNsYXNzPVwic3RyLWNoYXRfX2F0dGFjaG1lbnQtcHJldmlldy1maWxlLWRvd25sb2FkXCJcbiAgICAgICAgICAgIGRhdGEtdGVzdGNsYXNzPVwiZmlsZS1kb3dubG9hZC1saW5rXCJcbiAgICAgICAgICAgIGRvd25sb2FkXG4gICAgICAgICAgICBocmVmPVwie3sgYXR0YWNobWVudFVwbG9hZC51cmwgfX1cIlxuICAgICAgICAgICAgKGNsaWNrKT1cImF0dGFjaG1lbnRVcGxvYWQudXJsID8gbnVsbCA6ICRldmVudC5wcmV2ZW50RGVmYXVsdCgpXCJcbiAgICAgICAgICAgIChrZXl1cC5lbnRlcik9XCJcbiAgICAgICAgICAgICAgYXR0YWNobWVudFVwbG9hZC51cmwgPyBudWxsIDogJGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgICAgIFwiXG4gICAgICAgICAgPlxuICAgICAgICAgICAgPHN0cmVhbS1pY29uLXBsYWNlaG9sZGVyIGljb249XCJkb3dubG9hZFwiPjwvc3RyZWFtLWljb24tcGxhY2Vob2xkZXI+XG4gICAgICAgICAgPC9hPlxuICAgICAgICAgIDxzdHJlYW0tbG9hZGluZy1pbmRpY2F0b3ItcGxhY2Vob2xkZXJcbiAgICAgICAgICAgICpuZ0lmPVwiYXR0YWNobWVudFVwbG9hZC5zdGF0ZSA9PT0gJ3VwbG9hZGluZydcIlxuICAgICAgICAgICAgZGF0YS10ZXN0Y2xhc3M9XCJsb2FkaW5nLWluZGljYXRvclwiXG4gICAgICAgICAgPjwvc3RyZWFtLWxvYWRpbmctaW5kaWNhdG9yLXBsYWNlaG9sZGVyPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPG5nLWNvbnRhaW5lclxuICAgICAgICAgICpuZ1RlbXBsYXRlT3V0bGV0PVwiXG4gICAgICAgICAgICBkZWxldGVCdXR0b247XG4gICAgICAgICAgICBjb250ZXh0OiB7IGF0dGFjaG1lbnRVcGxvYWQ6IGF0dGFjaG1lbnRVcGxvYWQgfVxuICAgICAgICAgIFwiXG4gICAgICAgID48L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPG5nLWNvbnRhaW5lclxuICAgICAgICAgICpuZ1RlbXBsYXRlT3V0bGV0PVwiXG4gICAgICAgICAgICByZXRyeUJ1dHRvbjtcbiAgICAgICAgICAgIGNvbnRleHQ6IHsgYXR0YWNobWVudFVwbG9hZDogYXR0YWNobWVudFVwbG9hZCB9XG4gICAgICAgICAgXCJcbiAgICAgICAgPjwvbmctY29udGFpbmVyPlxuICAgICAgPC9kaXY+XG4gICAgPC9uZy1jb250YWluZXI+XG4gICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImN1c3RvbUF0dGFjaG1lbnRzUHJldmlld1wiPlxuICAgICAgPG5nLXRlbXBsYXRlXG4gICAgICAgICpuZ1RlbXBsYXRlT3V0bGV0PVwiXG4gICAgICAgICAgY3VzdG9tQXR0YWNobWVudHNQcmV2aWV3O1xuICAgICAgICAgIGNvbnRleHQ6IHsgc2VydmljZTogYXR0YWNobWVudFNlcnZpY2UgfVxuICAgICAgICBcIlxuICAgICAgPjwvbmctdGVtcGxhdGU+XG4gICAgPC9uZy1jb250YWluZXI+XG4gIDwvZGl2PlxuPC9kaXY+XG5cbjxuZy10ZW1wbGF0ZSAjZGVsZXRlQnV0dG9uIGxldC1hdHRhY2htZW50VXBsb2FkPVwiYXR0YWNobWVudFVwbG9hZFwiPlxuICA8ZGl2XG4gICAgY2xhc3M9XCJzdHItY2hhdF9fYXR0YWNobWVudC1wcmV2aWV3LWRlbGV0ZVwiXG4gICAgZGF0YS10ZXN0Y2xhc3M9XCJmaWxlLWRlbGV0ZVwiXG4gICAgcm9sZT1cImJ1dHRvblwiXG4gICAgKGNsaWNrKT1cImF0dGFjaG1lbnREZWxldGVkKGF0dGFjaG1lbnRVcGxvYWQpXCJcbiAgICAoa2V5dXAuZW50ZXIpPVwiYXR0YWNobWVudERlbGV0ZWQoYXR0YWNobWVudFVwbG9hZClcIlxuICA+XG4gICAgPHN0cmVhbS1pY29uLXBsYWNlaG9sZGVyIGljb249XCJjbG9zZVwiPjwvc3RyZWFtLWljb24tcGxhY2Vob2xkZXI+XG4gIDwvZGl2PlxuPC9uZy10ZW1wbGF0ZT5cblxuPG5nLXRlbXBsYXRlICNyZXRyeUJ1dHRvbiBsZXQtYXR0YWNobWVudFVwbG9hZD1cImF0dGFjaG1lbnRVcGxvYWRcIj5cbiAgPGRpdlxuICAgICpuZ0lmPVwiYXR0YWNobWVudFVwbG9hZC5zdGF0ZSA9PT0gJ2Vycm9yJ1wiXG4gICAgZGF0YS10ZXN0Y2xhc3M9XCJ1cGxvYWQtcmV0cnlcIlxuICAgIGNsYXNzPVwic3RyLWNoYXRfX2F0dGFjaG1lbnQtcHJldmlldy1lcnJvciBzdHItY2hhdF9fYXR0YWNobWVudC1wcmV2aWV3LWVycm9yLXt7XG4gICAgICBhdHRhY2htZW50VXBsb2FkLnR5cGUgPT09ICdpbWFnZScgPyAnaW1hZ2UnIDogJ2ZpbGUnXG4gICAgfX1cIlxuICAgIChjbGljayk9XCJhdHRhY2htZW50VXBsb2FkUmV0cmllZChhdHRhY2htZW50VXBsb2FkLmZpbGUpXCJcbiAgICAoa2V5dXAuZW50ZXIpPVwiYXR0YWNobWVudFVwbG9hZFJldHJpZWQoYXR0YWNobWVudFVwbG9hZC5maWxlKVwiXG4gID5cbiAgICA8c3RyZWFtLWljb24tcGxhY2Vob2xkZXIgaWNvbj1cInJldHJ5XCI+PC9zdHJlYW0taWNvbi1wbGFjZWhvbGRlcj5cbiAgPC9kaXY+XG48L25nLXRlbXBsYXRlPlxuIl19